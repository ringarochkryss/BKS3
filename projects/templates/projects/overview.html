{% extends "app/layout.html" %}

{% block content %}

<div class="row top-jumbo container-fluid glass">

	<h3>{{ project.name }}</h3>
	<p>
		{{ project.start_date }} - {{ project.end_date }}
	</p>

	<div class="col-8">
		<form method="post" action="{% url 'update_status' project.id %}" id="statusForm">
			{% csrf_token %}
			<table class="table table-bordered">
				<thead>
					<tr>
						<th>Foretagstyp</th>
						<th>Foretagsnamn</th>
						<th>Kontaktperson</th>
						<th>Telefon</th>
						<th>Email</th>
						<th>Aktuell Status</th>
						<th>Status Edit</th>
					</tr>
				</thead>
				<tbody>
					{% for project_company in project_companies %}
					<tr>
						<td>{% for omrade in project_company.company.omraden.all %}<span class="circleSm lightblue"><i class="{{ omrade.ikon }}"></i></span> {{ omrade.namn }} {% if not forloop.last %}, {% endif %}{% endfor %}</td>
						<td class="red">Name: {{ project_company.company.namn }}</td>
						<td>{{ project_company.company.kontaktperson }}</td>
						<td>{{ project_company.company.telefonnummer }}</td>
						<td>{{ project_company.company.epost }}</td>
						<td>
							{{ project_company.status.name }}
						</td>
						<td>
							<select name="status_{{ project_company.company.id }}" class="form-select" onchange="document.getElementById('statusForm').submit();">
								<option value="">Select Status</option>
								{% for status in statuses %} 
								<option value="{{ status.id }}" {% if project_company.status and project_company.status.id == status.id %}selected{% endif %}>{{ status.name }}</option>
								{% endfor %}
							</select>
						</td>
					</tr>
					{% empty %}
					<tr>
						<td colspan="7">Inga foretag kopplade till detta projekt.</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</form>
	</div>

	<div class="col-4">
		<div class="bg-white mp-0">
			<h4>Epostlista</h4>
			<ul>
				{% for project_company in project_companies %}
				<li>{{ project_company.company.epost }}</li>
				{% endfor %}
			</ul>
		</div>
	</div>

</div>

{% endblock %}
